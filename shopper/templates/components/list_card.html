{% load static %}

<div class="card bg-white border border-neutral-200 px-2 pt-9 cursor-pointer hover:shadow-md mt-16 sm:mt-14 sm:pt-16">
    <div class="relative">
        {% if "shopping" in request.path %}
        <a href="{% url 'shopping-center' shopping_center_id=item.id %}" class="space-y-2 lg:space-y-2">
            <div class="absolute -top-[65px] transform -translate-x-1/2 -mt-4 sm:-top-[120px] left-1/2">
                <div class="rounded-full w-24 sm:w-36">
                    {% if item.image %}
                    <img src="{% static 'img/shopping_center/'|add:item.image %}" alt="Logo"
                        class="w-24 h-24 sm:w-36 sm:h-36 rounded-full object-cover" style="border: .5px solid rgb(128,128,128); border-radius: 75px;" />
                    {% else %}
                    <img src="{% static 'img/no-image.png' %}" alt="Logo"
                        class="w-24 h-24 sm:w-36 sm:h-36 rounded-full object-cover" />
                    {% endif %}
                </div>
            </div>
        </a>
        {% else %}
        <a href="{% url 'retailer-details' item.id %}?origin=retailers" class="space-y-2 lg:space-y-2">
            <div class="absolute -top-[65px] transform -translate-x-1/2 -mt-4 sm:-top-[120px] left-1/2">
                <div class="rounded-full w-24 sm:w-36" style="border: .5px solid rgb(128,128,128); border-radius: 75px;">
                    {% if item.image.url %}
                    <img src="{{ item.image.url }}" alt="Logo"
                        class="w-24 h-24 sm:w-36 sm:h-36 rounded-full object-cover" />
                    {% elif item.image %}
                    <img src="{{ item.image }}" alt="Logo"
                        class="w-24 h-24 sm:w-36 sm:h-36 rounded-full object-cover" />
                    {% else %}
                    <img src="{% static 'img/no-image.png' %}" alt="Logo"
                        class="w-24 h-24 sm:w-36 sm:h-36 rounded-full object-cover" />
                    {% endif %}
                </div>
            </div>
        </a>
        {% endif %}
        <span
            class="absolute -top-[30px] sm:-top-[55px] right-0 mt-2 mr-2 rounded-full bg-w-light-smooth-gray p-1 cursor-pointer"
            id="favorite-span_{{ item.id }}" onclick="toggleFavorite({{ item.id }}, 'retailer', this)">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-6 h-6 text-white favorite stroke-red-600 {% if item.id in user_retailers_wishlist %}fill-white{% endif %}" id="favorite_{{ item.id }}">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
            </svg>
        </span>
    </div>
    <div class="card-body px-4 pb-2 md:pt-2">
        <a href="{% url 'retailer-details' item.id %}?origin=retailers" class="space-y-2 lg:space-y-2">
            <div
                class="grid justify-center text-center card-title font-medium text-neutral-800 text-base sm:text-xl line-clamp-2 md:pt-2 md:h-[65px]">
                {{ item.name }}
            </div>
            <div style="padding-bottom: 0.5rem" class="font-normal text-sm text-w-indigo flex gap-2 justify-center">
                {% if item.location %}
                <div style="padding-bottom: 2.5rem" class="grid line-clamp-2 h-9 text-center items-center">{{ item.location }}</div>
                {% else %}
                <div style="padding-bottom: 2.5rem" class="grid line-clamp-2 h-9 text-center items-center">{{ item.location_set.first.address1 }}, {{ item.location_set.first.city }}, {{ item.location_set.first.zip_code }}</div>
                {% endif %}
            </div>
            {% if score %}
            <div class="flex items-center pb-1 lg:h-10">
                <div class="font-normal text-sm text-neutral-800 pr-4">Reliability Score</div>
                {% if score == 0 %}
                <span class="text-xs font-normal text-neutral-400">N/A</span>
                {% else %}
                <progress
                    class="progress-bar {% if score < 30 %}progress-bar-danger {% elif score < 60 %}progress-bar-warning {% else %}progress-bar-success {% endif %} w-16 h-4"
                    value="{{ score }}" max="100"></progress>
                {% endif %}
            </div>
            {% endif %}
        </a>
    </div>
</div>